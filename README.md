# ObjectDetectoriOS

One of the exciting feature announced by Apple was CoreML,Its the Apple framework that can be used to integrate machine learning into your app.

App gets the current frames from the camera using AVCapture and it uses this frame to get predictions using the inception model.


Requirement
- Xcode 9 and above
- iOS 11

How it’s Work?

Consider our inception model as the black box when provided an input image gives you probability of that being one among the set of categories it know.

Just download the model from the Apple’s portal, drag and drop it (inceptionv3.mlmodel) to your project.

Usage

We can make use the prediction API generated by Xcode which looks like this:

/**
Make a prediction using the convenience interface
- parameters:
- image: Input image to be classified as RGB image buffer, 299 pixels wide by 299 pixels high
- throws: an NSError object that describes the problem
- returns: the result of the prediction as Inceptionv3Output
*/
func prediction(image: CVPixelBuffer) throws -> Inceptionv3Output {
let input_ = Inceptionv3Input(image: image)
return try self.prediction(input: input_)
}

/// Model Prediction Output Type
class Inceptionv3Output : MLFeatureProvider {

/// Probability of each category as dictionary of strings to doubles
let classLabelProbs: [String : Double]

/// Most likely image category as string value
let classLabel: String

// Class has other APIs and properties.
// ...

}


Prediction is simple:

var model = Inceptionv3()
let output = try? model.prediction(image: pixelBuffer)
let prediction = output?.classLabel ?? “Whats that?”

But it requires an object of CVPixelBuffer instead of UIImage for prediction, so I have created UIImage category which abstracts this along with the resize API.


extension UIImage {
func buffer() -> CVPixelBuffer? {
return UIImage.buffer(from: self)
}

static func buffer(from image: UIImage) -> CVPixelBuffer? {

}

func resizeTo(_ size: CGSize) -> UIImage? {
UIGraphicsBeginImageContext(size)
draw(in: CGRect(x: 0, y: 0, width: size.width, height: size.height))
let image = UIGraphicsGetImageFromCurrentImageContext()
UIGraphicsEndImageContext()
return image
}
}

Output:

![alt text](http://dev.acquaintsoft.com/detector.gif)

